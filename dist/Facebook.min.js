/*!
bower-facebook v0.0.0 
Convenience wrapper for the Facebook SDK
Build time: Fri May 03 2013 14:35:10 GMT+0100 (BST)
*/

(function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__slice=[].slice;define(["EventEmitter","module"],function(EventEmitter,module){var Facebook;return Facebook=function(_super){function Facebook(config){var defaults,_this=this;this.config=config,this.fbiFrameInit=__bind(this.fbiFrameInit,this),this.fbInit=__bind(this.fbInit,this),this.fbAsyncInit=__bind(this.fbAsyncInit,this),this.onReady=__bind(this.onReady,this),this.login=__bind(this.login,this),this.ui=__bind(this.ui,this),defaults={status:!0,cookie:!0,xfbml:!0},this.config=this.config.concat(defaults),console.log("FB constructor"),this.api=null,this.isIframe=top!==self,Facebook.__super__.constructor.call(this),"undefined"!=typeof FB&&null!==FB?this.fbAsyncInit():(window.fbAsyncInit=this.fbAsyncInit,this.injectFB()),this.onReady(function(FB){return FB.Event.subscribe("edge.create",function(url){return _this.fireEvent("onLike",url)}),FB.Event.subscribe("edge.remove",function(url){return _this.fireEvent("onUnlike",url)})})}return __extends(Facebook,_super),Facebook.prototype.ui=function(){var args;return args=arguments.length>=1?__slice.call(arguments,0):[],this.onReady(function(FB){return FB.ui.apply(FB,args)})},Facebook.prototype.login=function(callback,scope){var _ref;return null!=(null!=(_ref=this.loginStatus)?_ref.status:void 0)&&"connected"===this.loginStatus.status?callback(this.loginStatus):this.onReady(function(FB){return FB.login(callback,scope)})},Facebook.prototype.onReady=function(callback){return"undefined"!=typeof FB&&null!==FB?callback(FB):this.once("fbInit",function(){return callback(FB)})},Facebook.prototype.fbAsyncInit=function(){return this.fbInit(),this.isIframe?this.fbiFrameInit():void 0},Facebook.prototype.fbInit=function(){var _this=this;return FB.init({appId:this.config.appId,channelUrl:this.config.channelUrl,status:this.config.status,cookie:this.config.cookie,xfbml:this.config.xfbml}),FB.getLoginStatus(function(loginStatus){_this.loginStatus=loginStatus}),this.fireEvent("fbInit")},Facebook.prototype.fbiFrameInit=function(){var resizeInterval;return FB.Canvas.scrollTo(0,0),FB.Canvas.setSize({width:810,height:document.body.offsetHeight}),null!=this.config.autoResize&&this.config.autoResize?(resizeInterval=function(){return FB.Canvas.setSize({width:810,height:document.body.offsetHeight})},window.setInterval(resizeInterval,500)):void 0},Facebook.prototype.injectFB=function(){var root;if(!document.getElementById("facebook-jssdk"))return document.getElementById("fb-root")||(root=document.createElement("div"),root.setAttribute("id","fb-root"),document.body.appendChild(root)),requirejs(["//connect.facebook.net/en_US/all.js"])},Facebook.prototype.renderPlugins=function(cb){return this.onReady(function(){var cbStack,plugin,plugins,unrenderedCount,_i,_len,_results;if(null!=document.querySelectorAll){for(plugins=document.body.querySelectorAll(".fb-like:not([fb-xfbml-state=rendered])"),unrenderedCount=plugins.length,cbStack=function(){return unrenderedCount--,0===unrenderedCount?cb():void 0},_results=[],_i=0,_len=plugins.length;_len>_i;_i++)plugin=plugins[_i],_results.push(FB.XFBML.parse(document.body,cbStack));return _results}return FB.XFBML.parse(document.body,cb)})},Facebook.prototype.getCanvasInfo=function(cb){return this.onReady(function(FB){return FB.Canvas.getPageInfo(function(info){return cb(info)})})},Facebook.prototype.setCanvasSize=function(width,height){return this.onReady(function(FB){return FB.Canvas.setSize({width:width,height:height})})},Facebook}(EventEmitter),new Facebook(module.config())})}).call(this);